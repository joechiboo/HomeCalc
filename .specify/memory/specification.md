# HomeCalc - 產品規格

## 1. 概述

### 願景
打造一個簡潔、直覺的購屋財務計劃工具，幫助使用者清楚了解房貸還款狀況，做出最佳的財務決策。

### 目標
- 提供精確的房貸試算功能
- 視覺化呈現還款計劃與財務狀況
- 支援多種還款方案比較
- 協助使用者追蹤購屋財務目標

### 非目標
- 不提供真實的貸款申請服務
- 不儲存或傳輸敏感個人資料到伺服器
- 不提供投資建議或理財諮詢
- 階段一暫不實作「購屋後管理」功能

## 2. 使用者故事

### 場景 1：首次購屋者
身為**首次購屋者**，我要：
- 了解不同貸款金額和利率對每月負擔的影響
- 知道需要準備多少頭期款
- 評估自己的還款能力是否足夠

### 場景 2：現有房貸持有者
身為**現有房貸持有者**，我要：
- 清楚知道目前房貸還需要還多久
- 了解提高月付金額可以節省多少利息
- 比較不同還款策略的差異（如：先還其他貸款再提高房貸月付）

### 場景 3：財務規劃者
身為**財務規劃者**，我要：
- 快速試算多種還款方案
- 視覺化比較不同方案的總成本
- 匯出或分享試算結果

## 3. 功能需求

### 3.1 房貸試算器（核心功能 - MVP）

#### 3.1.1 基本輸入參數
- **房貸本金餘額**
  - 預設值：16,102,679 元（可自訂）
  - 輸入範圍：100,000 ~ 100,000,000 元
  - 即時驗證，超出範圍顯示警告

- **年利率**
  - 預設值：2.19%
  - 輸入範圍：0.1% ~ 10%
  - 支援小數點後兩位
  - 可選擇「固定利率」或「分段利率」（未來功能）

- **每月還款金額**
  - 預設值：70,000 元
  - 建議金額：64,432 元（最低）、70,000 元、80,000 元
  - 快速選擇按鈕 + 自訂輸入

#### 3.1.2 計算結果顯示
- **還款期限**
  - 總月數（如：299 個月）
  - 年月格式（如：24 年 11 個月）
  - 預計完成日期（如：2049 年 10 月）

- **財務摘要**
  - 總還款金額
  - 總利息支出
  - 利息佔總還款比例

- **每月還款組成**（前 3 期明細）
  - 第 N 期利息金額
  - 第 N 期本金償還
  - 剩餘本金

#### 3.1.3 還款計劃表
- **完整還款明細表**
  - 可展開/收合
  - 顯示每期：期數、利息、本金、剩餘本金
  - 支援跳轉到特定年份查看

- **里程碑提示**
  - 本金還清 25%、50%、75% 的時間點
  - 利息與本金交叉點（本金償還 > 利息）

### 3.2 方案比較功能

#### 3.2.1 多方案並列比較
- 最多同時比較 3 個方案
- 並列顯示：
  - 還款期限
  - 總還款金額
  - 總利息支出
  - 每月還款金額

#### 3.2.2 差異分析
- 提前還清時間
- 節省利息金額
- 每月差額成本
- 建議方案（根據總成本最低）

#### 3.3.3 常見方案預設
- 方案 A：保守型（月付 64,432，最低還款）
- 方案 B：穩健型（月付 70,000）
- 方案 C：積極型（月付 80,000）

### 3.3 分階段還款試算（進階功能）

#### 3.3.1 兩階段還款
- **第一階段**
  - 期間：自訂月數（如：4 個月）
  - 每月還款：自訂金額（如：70,000）
  - 用途說明：如「呼吸器貸款繳清前」

- **第二階段**
  - 期間：自動計算至還清
  - 每月還款：自訂金額（如：80,000）

- **結果顯示**
  - 兩階段分別的利息支出
  - 總還款期限
  - 與單一階段方案的比較

### 3.4 視覺化圖表

#### 3.4.1 本金與利息趨勢圖
- X 軸：時間（年）
- Y 軸：金額
- 兩條線：
  - 藍色：每月本金償還額
  - 紅色：每月利息支出
- 顯示交叉點（本金 > 利息的時間）

#### 3.4.2 還款進度圓餅圖
- 已還本金 vs. 剩餘本金
- 顯示百分比和金額

#### 3.4.3 總成本比較圖（方案比較時）
- 橫向長條圖
- 區分：本金、利息
- 不同方案並列顯示

### 3.5 購屋前規劃（階段二功能）

#### 3.5.1 頭期款累積追蹤
- 目標房價設定
- 頭期款比例（預設 20%）
- 每月儲蓄金額
- 預計達成時間

#### 3.5.2 購屋能力評估
- 每月可負擔金額
- 推算可貸款金額
- 推算可購買房價範圍

### 3.6 資料管理

#### 3.6.1 本地儲存
- 使用 LocalStorage 儲存最近的試算記錄
- 最多保存 5 筆記錄
- 快速載入過往試算

#### 3.6.2 匯出功能（未來功能）
- 匯出為 PDF
- 匯出為 Excel
- 分享連結（URL 參數編碼）

## 4. 技術規格

### 4.1 架構設計
```
HomeCalc/
├── src/
│   ├── components/
│   │   ├── MortgageCalculator.vue    # 主計算器
│   │   ├── ComparisonTable.vue       # 方案比較表
│   │   ├── PaymentChart.vue          # 還款圖表
│   │   ├── PaymentSchedule.vue       # 還款明細表
│   │   └── InputPanel.vue            # 輸入面板
│   ├── composables/
│   │   ├── useMortgageCalculator.js  # 房貸計算邏輯
│   │   └── useLocalStorage.js        # 本地儲存
│   ├── utils/
│   │   ├── mortgage.js               # 房貸計算函式
│   │   └── formatters.js             # 格式化工具
│   ├── App.vue
│   └── main.js
├── public/
├── .specify/
│   └── memory/
│       ├── constitution.md
│       └── specification.md
├── package.json
├── vite.config.js
└── README.md
```

### 4.2 核心計算公式

#### 4.2.1 本息平均攤還（等額本息）
```javascript
// 計算還款期數 n
n = -log(1 - P × r / A) / log(1 + r)

// 其中：
// P = 本金餘額
// r = 月利率（年利率 ÷ 12）
// A = 每月還款金額
// n = 還款期數（月）
```

#### 4.2.2 每期利息與本金
```javascript
// 第 i 期利息
I_i = P_remaining × r

// 第 i 期本金償還
Principal_i = A - I_i

// 剩餘本金
P_remaining = P_remaining - Principal_i
```

### 4.3 資料模型

#### 4.3.1 貸款方案 (MortgagePlan)
```typescript
interface MortgagePlan {
  id: string;
  name: string;                    // 方案名稱
  principal: number;               // 本金餘額
  annualRate: number;              // 年利率 (%)
  monthlyPayment: number;          // 每月還款
  graceMonths?: number;            // 寬限期（未來功能）
  createdAt: Date;
}
```

#### 4.3.2 計算結果 (CalculationResult)
```typescript
interface CalculationResult {
  totalMonths: number;             // 總還款月數
  years: number;                   // 年
  months: number;                  // 月
  totalPayment: number;            // 總還款金額
  totalInterest: number;           // 總利息
  monthlyBreakdown: MonthlyDetail[]; // 每月明細
  completionDate: Date;            // 預計完成日期
}

interface MonthlyDetail {
  month: number;                   // 第幾期
  interest: number;                // 利息
  principal: number;               // 本金
  remaining: number;               // 剩餘本金
}
```

### 4.4 預設值配置
```javascript
const DEFAULT_VALUES = {
  principal: 16102679,           // 真實房貸本金
  annualRate: 2.19,              // 當前利率
  monthlyPayment: 70000,         // 預估還款能力
  suggestions: {
    minimum: 64432,              // 最低還款
    standard: 70000,             // 標準還款
    aggressive: 80000,           // 積極還款
  },
};
```

## 5. UI/UX 設計

### 5.1 介面佈局

#### 5.1.1 桌面版（> 1024px）
```
+----------------------------------+
|         HomeCalc Logo            |
+----------------------------------+
|  輸入面板    |    結果顯示區     |
|  - 本金      |    - 還款期限     |
|  - 利率      |    - 財務摘要     |
|  - 月付      |    - 圖表視覺化   |
|              |    - 前3期明細    |
+----------------------------------+
|      完整還款計劃表（可展開）     |
+----------------------------------+
```

#### 5.1.2 行動版（< 768px）
- 垂直排列
- 輸入面板在上
- 結果顯示在下
- 圖表可左右滑動

### 5.2 視覺設計原則

#### 5.2.1 色彩方案
- **主色**：藍色系（#3B82F6）- 代表信任、穩定
- **強調色**：綠色（#10B981）- 代表節省、正向
- **警示色**：橙色（#F59E0B）- 代表警告
- **錯誤色**：紅色（#EF4444）- 代表錯誤、利息

#### 5.2.2 字體
- **標題**：思源黑體 / Noto Sans TC（Bold）
- **內文**：思源黑體 / Noto Sans TC（Regular）
- **數字**：Roboto Mono（易讀的等寬字體）

#### 5.2.3 互動回饋
- 即時計算：輸入改變後 300ms 自動重新計算
- 載入動畫：計算過程顯示 Skeleton Loading
- 成功提示：綠色勾選圖示 + Toast 訊息
- 錯誤提示：紅色警示 + 說明文字

### 5.3 UI 元件規格

#### 5.3.1 數字輸入框
- 支援千分位逗號顯示（如：16,102,679）
- 焦點時移除逗號，便於編輯
- 失焦時自動格式化
- 右側單位標示（元、%）

#### 5.3.2 快速選擇按鈕
```
[64,432 最低] [70,000 標準] [80,000 積極] [自訂...]
```
- 點擊直接套用金額
- 當前選中狀態高亮顯示

#### 5.3.3 結果卡片
- 圓角矩形（border-radius: 12px）
- 輕微陰影（shadow-sm）
- 數字大字顯示，單位小字
- 重要數據（總利息）用強調色

## 6. 隱私與資料保護

### 6.1 資料處理原則
- 所有計算在**客戶端**完成
- 不傳送任何資料到伺服器
- LocalStorage 僅儲存試算記錄，不儲存個人資訊

### 6.2 敏感資料處理
- **年收入欄位**：預設隱藏（依用戶要求）
- **房貸本金**：可使用預設值或自訂
- **匯出功能**：僅包含計算結果，不含個人識別資訊

## 7. 成功指標

### 7.1 技術指標
- **效能**
  - 頁面載入時間 < 2 秒
  - 計算回應時間 < 100ms
  - Lighthouse 效能分數 > 90

- **品質**
  - 計算準確度 100%（與銀行試算結果一致）
  - 無 console 錯誤
  - 跨瀏覽器相容性 100%

### 7.2 使用者體驗指標
- 首次使用者 3 分鐘內完成第一次試算
- 直覺操作，無需查看說明文件
- 行動裝置操作流暢（60fps）

### 7.3 功能完整性
- [ ] MVP 核心功能：房貸試算器
- [ ] 方案比較功能
- [ ] 視覺化圖表
- [ ] 本地儲存
- [ ] 響應式設計

## 8. 實作階段

### 階段 1：MVP（最小可行產品）
**目標：完成核心房貸試算功能**

- [ ] 專案建置（Vite + Vue 3）
- [ ] 房貸計算邏輯實作
  - [ ] 本息平均攤還計算
  - [ ] 每月明細計算
  - [ ] 單元測試
- [ ] 基本 UI 介面
  - [ ] 輸入面板（本金、利率、月付）
  - [ ] 結果顯示（期限、總額、利息）
  - [ ] 前 3 期明細表
- [ ] 響應式設計（桌面 + 行動）
- [ ] 預設值設定（真實房貸數據）

**交付標準**
- 計算結果與手動計算一致
- 三種裝置測試通過（桌面、平板、手機）
- 無 console 錯誤

### 階段 2：視覺化與比較
**目標：增強視覺化和方案比較**

- [ ] 圖表整合
  - [ ] 本金/利息趨勢圖（Chart.js）
  - [ ] 還款進度圓餅圖
  - [ ] 互動式 tooltip
- [ ] 方案比較功能
  - [ ] 多方案並列顯示
  - [ ] 差異分析計算
  - [ ] 建議方案標示
- [ ] 完整還款明細表
  - [ ] 可展開/收合
  - [ ] 虛擬滾動（效能優化）
- [ ] 本地儲存
  - [ ] 保存最近 5 筆試算
  - [ ] 快速載入

**交付標準**
- 圖表載入流暢，無卡頓
- 方案比較邏輯正確
- LocalStorage 正常運作

### 階段 3：進階功能
**目標：分階段還款與進階試算**

- [ ] 分階段還款試算
  - [ ] 兩階段設定介面
  - [ ] 分階段計算邏輯
  - [ ] 階段比較視覺化
- [ ] 寬限期試算（未來功能）
- [ ] 匯出功能
  - [ ] PDF 匯出
  - [ ] 分享連結
- [ ] 使用者偏好設定
  - [ ] 隱藏/顯示欄位
  - [ ] 主題切換（亮/暗）

**交付標準**
- 分階段計算準確
- 匯出格式美觀
- 設定持久化

### 階段 4：購屋前規劃（延後）
**目標：頭期款追蹤與購屋能力評估**

- [ ] 頭期款累積追蹤
- [ ] 目標房價設定
- [ ] 購屋能力評估
- [ ] 儲蓄計劃視覺化

### 階段 5：購屋後管理（延後）
**目標：持續追蹤房貸狀態**

- [ ] 每月繳款提醒
- [ ] 已繳本金/利息統計
- [ ] 提前還款模擬

## 9. 待決定事項

- [ ] **圖表函式庫選擇**
  - 選項：Chart.js vs. ECharts
  - 考量：檔案大小、功能完整性、易用性
  - 建議：Chart.js（輕量、足夠功能）

- [ ] **UI 元件庫選擇**
  - 選項：Element Plus vs. Naive UI vs. 原生實作
  - 考量：風格一致性、bundle 大小
  - 建議：Naive UI（輕量、現代設計）

- [ ] **CSS 框架**
  - 選項：Tailwind CSS vs. 原生 CSS
  - 考量：開發速度 vs. 學習曲線
  - 建議：Tailwind CSS（快速開發）

- [ ] **部署方式**
  - 選項：GitHub Pages、Vercel、Netlify
  - 考量：自動部署、HTTPS、自訂網域
  - 建議：Vercel（免費、自動部署）

## 10. 未來功能（Backlog）

### 優先級：高
- 寬限期試算
- 本金平均攤還（與本息攤還對比）
- 提前還款試算（一次性還款）

### 優先級：中
- 多種利率模式（階梯式、浮動利率）
- 不同銀行方案比較（預設方案庫）
- 稅務相關試算（利息抵稅）

### 優先級：低
- 使用者帳號系統（雲端同步）
- 多語言支援（英文）
- PWA 離線支援
- 分享到社群媒體

## 11. 參考資料

### 競品分析
- 永豐銀行房貸試算：https://bank.sinopac.com/...
- 台新銀行房貸試算：https://www.taishinbank.com.tw/...
- 好時貸房貸計算機：https://...

### 計算公式參考
- 本息平均攤還公式：[維基百科 - 年金](https://zh.wikipedia.org/wiki/年金)
- 銀行公會房貸試算標準

---

**版本**：1.0
**最後更新**：2025-11-14
**負責人**：HomeCalc 開發團隊
**狀態**：規格確認中

## 附錄 A：名詞解釋

- **本金**：貸款的原始金額，不含利息
- **本息攤還**：每月還款金額固定，包含本金和利息
- **本金攤還**：每月償還固定本金，利息逐月遞減
- **寬限期**：只繳利息不還本金的期間
- **提前還款**：在約定期限前償還部分或全部貸款

## 附錄 B：測試案例

### 測試案例 1：標準方案
```
輸入：
- 本金：16,102,679
- 年利率：2.19%
- 月付：70,000

預期輸出：
- 還款期數：298.58 個月
- 還款期限：24 年 11 個月
- 總利息：約 4,798,103 元
```

### 測試案例 2：積極方案
```
輸入：
- 本金：16,102,679
- 年利率：2.19%
- 月付：80,000

預期輸出：
- 還款期數：251.09 個月
- 還款期限：20 年 11 個月
- 總利息：約 3,984,707 元
- vs. 標準方案節省：約 813,395 元
```

### 測試案例 3：最低還款
```
輸入：
- 本金：16,102,679
- 年利率：2.16%
- 月付：64,432

預期輸出：
- 還款期數：約 371 個月
- 還款期限：約 30 年 11 個月
- 總利息：約 7,771,625 元
```
